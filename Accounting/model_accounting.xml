<xmodel version="2" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
    xsi:noNamespaceSchemaLocation='http://flame.ac.uk/schema/xmml_v2.xsd'>
    <!-- Model descriptions  -->
    <name>ICEACE</name>
    <version>Version 0.1.4, 17/04/2012</version>
    <description> Balance sheet accounting model.</description>
    <environment>
        <constants>
            <variable>
                <type>double</type>
                <name>ratio_debt_firm</name>
                <description>Ratio of debt to be paid by a firm.</description>
            </variable>
            <variable>
                <type>double</type>
                <name>ratio_capitalist_households</name>
                <description>It is the rate of households owning firm shares.</description>
            </variable>
        </constants>
        <functionFiles>
        <!-- List of C files that hold agent functions -->
            <file>household_functions_accounting.c</file>
            <file>firm_functions_accounting.c</file>
            <file>bank_functions_accounting.c</file>
            <file>centralbank_functions_accounting.c</file>
            <file>government_functions_accounting.c</file>
            <file>equityfund_functions_accounting.c</file>
        </functionFiles>
        <dataTypes/>
    </environment>
	<!-- List of agents -->
    <agents>
        <xagent>
            <name>household</name>
            <description>Household in ICEACE model.</description>
            <!-- Agent memory holding a list of variables -->
            <memory>
                <variable>
                    <type>double</type>
                    <name>mortgages</name>
                    <description>Total mortgage.</description>
                </variable>
                <variable>
                    <type>double</type>
                    <name>housing_payment</name>
                    <description>Holds total mortgage payment done within the last quarter.</description>
                </variable>
                <variable>
                    <type>double</type>
                    <name>equity</name>
                <description>Household equity.</description>
                </variable>
                <variable>
                    <type>double</type>
                    <name>housing_price</name>
                    <description>Market value of a unit housing.</description>
                </variable>
                <variable>
                    <type>int</type>
                    <name>housing_units</name>
                    <description>Number of housing units owned by a household.</description>
                </variable>
                <variable>
                    <type>int</type>
                    <name>dividends</name>
                    <description>Number of dividends an household owns.</description>
                </variable>
                <variable>
                    <type>double</type>
                    <name>liquidity</name>
                    <description>Liquidity.</description>
                </variable>
                <variable>
                    <type>double</type>
                    <name>fund_shares</name>
                    <description>Equity fund shares.</description>
                </variable>
                <variable>
                    <type>int</type>
                    <name>previous_wages[3]</name>
                    <description>Holds wages earned in three previous months.</description>
                </variable>
            </memory>
            <!-- List of agent functions -->
            <functions>
                <function>
                    <name>idle</name>
                    <description>It is not the start of a new quarter.</description>
                    <currentState>HHAccountingStart</currentState>
                    <nextState>HHLabourStart</nextState>
                    <condition>
                        <not><time>
                            <period>quarterly</period>
                            <phase>1</phase>
                        </time></not>
                    </condition>
                </function>
                <function>
                    <name>idle</name>
                    <description>It is the start of a new quarter.</description>
                    <currentState>HHAccountingStart</currentState>
                    <nextState>HHAccountingIsCapitalist</nextState>
                    <condition>
                        <time>
                            <period>quarterly</period>
                            <phase>1</phase>
                        </time>
                    </condition>
                </function>
                <function>
                    <name>idle</name>
                    <description>The household does not own any shares of firms.</description>
                    <currentState>HHAccountingIsCapitalist</currentState>
                    <nextState>HHAccountingBalanceSheet</nextState>
                    <condition>
                        <lhs><value>a.dividends</value></lhs>
                        <op>EQ</op>
                        <rhs><value>0</value></rhs>
                    </condition>
                </function>
                <function>
                    <name>household_accounting_collect_shares</name>
                    <description>At the end of a quarter household recieves shares from the firms via Equity Fund.</description>
                    <currentState>HHAccountingIsCapitalist</currentState>
                    <nextState>HHAccountingBalanceSheet</nextState>
                    <condition>
                        <lhs><value>a.dividends</value></lhs>
                        <op>GT</op>
                        <rhs><value>0</value></rhs>
                    </condition>
                    <inputs>
                        <input>
                            <messageName>household_share</messageName>
                        </input>
                    </inputs>
                </function>
                <function>
                    <name>household_accounting_do_balance_sheet</name>
                    <description>Computing the balance sheet.</description>
                    <currentState>HHAccountingBalanceSheet</currentState>
                    <nextState>HHLabourStart</nextState>
                </function>
            </functions>
        </xagent>
        <xagent>
            <name>firm</name>
            <description>A production or constructor agent.</description>
            <!-- Agent memory holding a list of variables -->
            <memory>
                <variable>
                    <type>double</type>
                    <name>debt</name>
                    <description>Total debt of the firm.</description>
                </variable>
                <variable>
                    <type>int</type>
                    <name>inventory</name>
                    <description>Unsold inventory from previous month.</description>
                </variable>
                <variable>
                    <type>int</type>
                    <name>sales</name>
                    <description>Total number of sales within a month.</description>
                </variable>
                <variable>
                    <type>double</type>
                    <name>revenue</name>
                    <description>Total revenue from sales. It is offset quarterly.</description>
                </variable>
                <variable>
                    <type>double</type>
                    <name>costs</name>
                    <description>Total production and operation costs.</description>
                </variable>
                <variable>
                    <type>double</type>
                    <name>equity</name>
                    <description>Firm equity.</description>
                </variable>
                <variable>
                    <type>double</type>
                    <name>liquidity</name>
                    <description>Liquidity.</description>
                </variable>
                <variable>
                <type>double</type>
                    <name>capital_goods</name>
                    <description>Capital Goods.</description>
                </variable>
            </memory>
            <!-- List of agent functions -->
            <functions>
                <function>
                    <name>idle</name>
                    <description>It is not the end/start of a quarter.</description>
                    <currentState>FirmAccountingStart</currentState>
                    <nextState>FirmProductionStart</nextState>
                    <condition>
                        <not><time>
                            <period>quarterly</period>
                            <phase>1</phase>
                        </time></not>
                    </condition>
                </function>
                <function>
                    <name>firm_accounting_distribute_net_profit</name>
                    <description>At the end of a quarter, a firm sends net profit to the equity fund.</description>
                    <currentState>FirmAccountingStart</currentState>
                    <nextState>FirmAccountingBalanceSheet</nextState>
                    <condition>
                        <time>
                            <period>quarterly</period>
                            <phase>1</phase>
                        </time>
                    </condition>
                    <outputs>
                        <output>
                            <messageName>firm_net_profit</messageName>
                        </output>
                    </outputs>
                </function>
                <function>
                    <name>firm_accounting_do_balance_sheet</name>
                    <description>Updating the balance sheet.</description>
                    <currentState>FirmAccountingBalanceSheet</currentState>
                    <nextState>FirmProductionStart</nextState>
                </function>
            </functions>
        </xagent>
        <xagent>
            <name>equityfund</name>
            <description>The Equity Fund agency.</description>
            <!-- Agent memory holding a list of variables -->
            <memory>
                <variable>
                    <type>double</type>
                    <name>share_firms</name>
                    <description>Shares owned by regular firms.</description>
                </variable>
                <variable>
                    <type>double</type>
                    <name>share_construction_firms</name>
                    <description>Shares owned by constructor firms.</description>
                </variable>
                <variable>
                    <type>double</type>
                    <name>share_banks</name>
                    <description>Shares owned by banks.</description>
                </variable>
                <variable>
                    <type>double</type>
                    <name>equity</name>
                    <description>Firm equity.</description>
                </variable>
                <variable>
                    <type>double</type>
                    <name>liquidity</name>
                    <description>Liquidity.</description>
                </variable>
                <variable>
                    <type>int</type>
                    <name>n_dividends</name>
                    <description>Number of households to recieve liquid shares from firm net income.</description>
                </variable>
            </memory>
            <!-- List of agent functions -->
            <functions>
                <function>
                    <name>idle</name>
                    <description>It is not the end/start of a quarter.</description>
                    <currentState>EFAccountingStart</currentState>
                    <nextState>end</nextState>
                    <condition>
                        <not><time>
                            <period>quarterly</period>
                            <phase>1</phase>
                        </time></not>
                    </condition>
                </function>
                <function>
                    <name>equityfund_accounting_collect_firm_shares</name>
                    <description>At the end of a quarter collect net income from the firms in the market.</description>
                    <currentState>EFAccountingStart</currentState>
                    <nextState>EFAccountingDistributeShares</nextState>
                    <condition>
                        <time>
                            <period>quarterly</period>
                            <phase>1</phase>
                        </time>
                    </condition>
                    <inputs>
                        <input>
                            <messageName>firm_net_profit</messageName>
                        </input>
                    </inputs>
                </function>
                <function>
                    <name>equityfund_accounting_distribute_shares</name>
                    <description>At the end of a quarter net income per household is distributed.</description>
                    <currentState>EFAccountingDistributeShares</currentState>
                    <nextState>EFAccountingBalanceSheet</nextState>
                    <outputs>
                        <output>
                            <messageName>household_share</messageName>
                        </output>
                    </outputs>
                </function>
                <function>
                    <name>equityfund_accounting_do_balance_sheet</name>
                    <description>Equity fund balance sheet accounting activities.</description>
                    <currentState>EFAccountingBalanceSheet</currentState>
                    <nextState>end</nextState>
                </function>
            </functions>
        </xagent>
        <xagent>
            <name>bank</name>
            <description>A bank agent.</description>
            <!-- Agent memory holding a list of variables -->
            <memory>
                <variable>
                    <type>double</type>
                    <name>loans</name>
                    <description>loans to firms.</description>
                </variable>
                <variable>
                    <type>double</type>
                    <name>mortgages</name>
                    <description>Mortgages to households.</description>
                </variable>
                <variable>
                    <type>double</type>
                    <name>deposits</name>
                    <description>Deposits recieved from private sector.</description>
                </variable>
                <variable>
                    <type>double</type>
                    <name>debt</name>
                    <description>Debt to central bank.</description>
                </variable>
                <variable>
                    <type>double</type>
                    <name>equity</name>
                    <description>Firm equity.</description>
                </variable>
                <variable>
                    <type>double</type>
                    <name>liquidity</name>
                    <description>Liquidity.</description>
                </variable>
            </memory>
            <!-- List of agent functions -->
            <functions>
                <function>
                    <name>idle</name>
                    <description>It is not the end/start of a quarter.</description>
                    <currentState>BankAccountingStart</currentState>
                    <nextState>end</nextState>
                    <condition>
                        <not><time>
                            <period>quarterly</period>
                            <phase>1</phase>
                        </time></not>
                    </condition>
                </function>
                <function>
                    <name>bank_accounting_do_balance_sheet</name>
                    <description>Bank balance sheet accounting activities.</description>
                    <currentState>BankAccountingStart</currentState>
                    <nextState>end</nextState>
                    <condition>
                        <time>
                            <period>quarterly</period>
                            <phase>1</phase>
                        </time>
                    </condition>
                </function>
            </functions>
        </xagent>
        <xagent>
            <name>centralbank</name>
            <description>A simple central bank agent.</description>
            <!-- Agent memory holding a list of variables -->
            <memory>
                <variable>
                    <type>double</type>
                    <name>liquidity</name>
                    <description>Central Bank liquidity</description>
                </variable>
                <variable>
                    <type>double</type>
                    <name>loans_banks</name>
                    <description>loans to firms.</description>
                </variable>
                <variable>
                    <type>double</type>
                    <name>loans_government</name>
                    <description>loans to the government.</description>
                </variable>
                <variable>
                    <type>double</type>
                    <name>fiat_money</name>
                    <description>Outstanding fiat money.</description>
                </variable>
                <variable>
                    <type>double</type>
                    <name>equity</name>
                    <description>Firm equity.</description>
                </variable>
                <variable>
                    <type>double</type>
                    <name>liquidity_banks</name>
                    <description>Liquidity kept for banks.</description>
                </variable>
                    <variable>
                    <type>double</type>
                    <name>liquidity_government</name>
                    <description>Liquidity kept for the government.</description>
                </variable>
            </memory>
            <!-- List of agent functions -->
            <functions>
                <function>
                    <name>idle</name>
                    <description>It is not the end/start of a quarter.</description>
                    <currentState>CBAccountingStart</currentState>
                    <nextState>end</nextState>
                    <condition>
                        <not><time>
                            <period>quarterly</period>
                            <phase>1</phase>
                        </time></not>
                    </condition>
                </function>
                <function>
                    <name>centralbank_accounting_do_balance_sheet</name>
                    <description>Central Bank balance sheet accounting activities.</description>
                    <currentState>CBAccountingStart</currentState>
                    <nextState>end</nextState>
                    <condition>
                        <time>
                            <period>quarterly</period>
                            <phase>1</phase>
                        </time>
                    </condition>
                </function>
            </functions>
        </xagent>
        <xagent>
            <name>government</name>
            <description>A simple government agent</description>
            <!-- Agent memory holding a list of variables -->
            <memory>
                <variable>
                    <type>double</type>
                    <name>debt</name>
                    <description>Debt to central bank.</description>
                </variable>
                <variable>
                    <type>double</type>
                    <name>equity</name>
                    <description>Government equity.</description>
                </variable>
                <variable>
                    <type>double</type>
                    <name>liquidity</name>
                    <description>Government liquidity.</description>
                </variable>
            </memory>
            <!-- List of agent functions -->
            <functions>
                <function>
                    <name>idle</name>
                    <description>It is not the end/start of a quarter.</description>
                    <currentState>GovAccountingStart</currentState>
                    <nextState>end</nextState>
                    <condition>
                        <not><time>
                            <period>quarterly</period>
                            <phase>1</phase>
                        </time></not>
                    </condition>
                </function>
                <function>
                    <name>government_accounting_do_balance_sheet</name>
                    <description>Government balance sheet accounting activities.</description>
                    <currentState>GovAccountingStart</currentState>
                    <nextState>end</nextState>
                    <condition>
                        <time>
                            <period>quarterly</period>
                            <phase>1</phase>
                        </time>
                    </condition>
                </function>
            </functions>
        </xagent>
    </agents>
    <messages>
        <message>
            <name>firm_net_profit</name>
            <description>Net income send to Equity Fund.</description>
            <variables>
                <variable>
                    <type>int</type>
                    <name>id</name>
                    <description>Firm agent ID.</description>
                </variable>
                <variable>
                    <type>int</type>
                    <name>isconstructor</name>
                    <description>Flag to label whether the income is recieved from a constructor firm.</description>
                </variable>
                <variable>
                    <type>double</type>
                    <name>net_income</name>
                    <description>Net income to be distributed.</description>
                </variable>
            </variables>
        </message>
        <message>
            <name>household_share</name>
            <description>Shares are sent to households.</description>
            <variables>
                <variable>
                    <type>double</type>
                    <name>amount</name>
                    <description>Share per household.</description>
                </variable>
            </variables>
        </message>
    </messages>
</xmodel>